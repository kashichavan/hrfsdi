<!-- templates/home_dashboard.html -->
{% extends 'base.html' %}

{% block title %}Dashboard - Student Management System{% endblock %}

{% block extra_css %}
<style>
    /* Dashboard Styles */
    .dashboard-container {
        padding: 20px;
    }

    .stats-card {
        background: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
    }

    .stats-card:hover {
        transform: translateY(-5px);
    }

    .stats-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        margin-bottom: 15px;
    }

    .stats-number {
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .stats-label {
        color: #6c757d;
        font-size: 14px;
    }

    .requirement-list {
        background: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .requirement-item {
        padding: 15px;
        border-bottom: 1px solid #eee;
        transition: background-color 0.3s ease;
    }

    .requirement-item:hover {
        background-color: #f8f9fa;
    }

    .schedule-badge {
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: 500;
    }

    .quick-actions {
        margin-top: 20px;
    }

    .action-button {
        width: 100%;
        padding: 15px;
        border-radius: 10px;
        border: none;
        background: #f8f9fa;
        transition: all 0.3s ease;
        text-align: left;
        margin-bottom: 10px;
    }

    .action-button:hover {
        background: #e9ecef;
        transform: translateX(5px);
    }

    .three-container {
        width: 100%;
        height: 200px;
        margin: 40px 0;
        position: relative;
    }

    .button-container {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin-top: 20px;
    }

    .three-button {
        position: relative;
        padding: 20px 40px;
        font-size: 24px;
        border: none;
        background: none;
        color: #fff;
        cursor: pointer;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .three-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, #FF3366, #FF6B6B);
        border-radius: 10px;
        z-index: -1;
        transform: translateY(100%);
        transition: transform 0.3s ease;
    }

    .three-button:hover::before {
        transform: translateY(0);
    }

    .three-button-text {
        position: relative;
        z-index: 1;
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <h1>Dashboard</h1>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="row mb-4">
        <!-- Total Students -->
        <div class="col-md-3 mb-3">
            <div class="stats-card">
                <div class="stats-icon bg-primary text-white">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stats-number">{{ total_students }}</div>
                <div class="stats-label">Total Students</div>
            </div>
        </div>

        <!-- Total Requirements -->
        <div class="col-md-3 mb-3">
            <div class="stats-card">
                <div class="stats-icon bg-success text-white">
                    <i class="fas fa-briefcase"></i>
                </div>
                <div class="stats-number">{{ total_requirements }}</div>
                <div class="stats-label">Total Requirements</div>
            </div>
        </div>

        <!-- Scheduled Today -->
        <div class="col-md-3 mb-3">
            <div class="stats-card">
                <div class="stats-icon bg-info text-white">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div class="stats-number">{{ scheduled_today }}</div>
                <div class="stats-label">Scheduled Today</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="col-md-3 mb-3">
            <div class="stats-card">
                <h5 class="mb-3">Quick Actions</h5>
                <a href="{% url 'add_requirement' %}" class="btn btn-primary btn-sm mb-2 w-100">
                    <i class="fas fa-plus"></i> Add Requirement
                </a>
                <a href="{% url 'home_dashboard' %}" class="btn btn-success btn-sm w-100">
                    <i class="fas fa-user-plus"></i> Add Student
                </a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="row">
        <!-- Today's Schedule -->
        <div class="col-md-8 mb-4">
            <div class="requirement-list">
                <h5 class="mb-4">Today's Scheduled Requirements</h5>
                {% if todays_requirements %}
                    {% for req in todays_requirements %}
                        <div class="requirement-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-1">{{ req.company_name }}</h6>
                                    <small class="text-muted">{{ req.position }}</small>
                                </div>
                                <div>
                                    <span class="schedule-badge bg-primary text-white">
                                        {{ req.schedule_time|time:"g:i A" }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="text-center text-muted py-4">
                        No requirements scheduled for today
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Recent Activities -->
        <div class="col-md-4">
            <!-- Recent Students -->
            <div class="requirement-list mb-4">
                <h5 class="mb-3">Recent Students</h5>
                {% for student in recent_students %}
                    <div class="requirement-item">
                        <h6 class="mb-1">{{ student.name }}</h6>
                        <small class="text-muted">{{ student.degree }} - {{ student.stream }}</small>
                    </div>
                {% endfor %}
            </div>

            <!-- Requirement Stats -->
            <div class="requirement-list">
                <h5 class="mb-3">Requirement Status</h5>
                {% for stat in requirement_stats %}
                    <div class="d-flex justify-content-between mb-2">
                        <span>{{ stat.schedule_status|title }}</span>
                        <span class="badge bg-primary">{{ stat.count }}</span>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
<div class="dashboard-container">
    <!-- 3D Text Container -->
    <div class="three-container"></div>

    <!-- Interactive Buttons -->
    <div class="button-container">
        <button class="three-button" onclick="window.location.href='{% url 'requirement_list' %}'">
            <span class="three-button-text">Requirements</span>
        </button>
        <button class="three-button" onclick="window.location.href='{% url 'student_list' %}'">
            <span class="three-button-text">Students</span>
        </button>
    </div>

    <!-- Rest of your dashboard content remains the same -->
    <!-- ... -->
</div>
{% endblock %}


<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js"></script>
<script>
// Three.js setup
let container, scene, camera, renderer;
let textMeshes = [];

function init() {
    // Create scene
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, window.innerWidth / 200, 0.1, 1000);
    
    // Create renderer
    renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, 200);
    container = document.querySelector('.three-container');
    container.appendChild(renderer.domElement);

    // Add lights
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
    scene.add(ambientLight);
    
    const pointLight = new THREE.PointLight(0xffffff, 1);
    pointLight.position.set(5, 5, 5);
    scene.add(pointLight);

    // Position camera
    camera.position.z = 5;

    // Load font
    const loader = new THREE.FontLoader();
    loader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function(font) {
        createText('Requirements', font, -2);
        createText('Students', font, 2);
    });

    // Animation loop
    animate();
}

function createText(text, font, xPosition) {
    const geometry = new THREE.TextGeometry(text, {
        font: font,
        size: 0.5,
        height: 0.2,
        curveSegments: 12,
        bevelEnabled: true,
        bevelThickness: 0.03,
        bevelSize: 0.02,
        bevelOffset: 0,
        bevelSegments: 5
    });

    const material = new THREE.MeshPhongMaterial({ 
        color: 0xFF3366,
        specular: 0x555555,
        shininess: 30
    });

    const mesh = new THREE.Mesh(geometry, material);
    geometry.center();
    mesh.position.x = xPosition;
    scene.add(mesh);
    textMeshes.push(mesh);

    // GSAP Animation
    gsap.to(mesh.rotation, {
        y: Math.PI * 2,
        duration: 8,
        repeat: -1,
        ease: "none"
    });
}

function animate() {
    requestAnimationFrame(animate);
    renderer.render(scene, camera);
}

// Initialize on load
window.addEventListener('load', init);

// Handle button clicks
document.querySelectorAll('.three-button').forEach(button => {
    button.addEventListener('click', (e) => {
        gsap.to(e.target, {
            scale: 1.1,
            duration: 0.2,
            yoyo: true,
            repeat: 1
        });
    });
});
</script>